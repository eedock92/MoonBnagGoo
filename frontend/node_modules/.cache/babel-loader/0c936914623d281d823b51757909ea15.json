{"ast":null,"code":"var _jsxFileName = \"D:\\\\ByungSoo\\\\DEV\\\\potfolio\\\\ecommerce_react\\\\frontend\\\\src\\\\screens\\\\OrderScreen.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { PayPalButton } from 'react-paypal-button-v2';\nimport { Link } from 'react-router-dom';\nimport { Row, Col, ListGroup, Image, Card, Button } from 'react-bootstrap';\nimport { useDispatch, useSelector } from 'react-redux';\nimport Message from '../components/Message';\nimport Loader from '../components/Loader';\nimport { deliverOrder, getOrderDetails, payOrder } from '../actions/orderActions';\nimport { ORDER_DELIVER_RESET, ORDER_PAY_RESET } from '../constants/orderConstants';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst OrderScreen = ({\n  match\n}) => {\n  _s();\n\n  const orderId = match.params.id;\n  const [sdkReady, setSdkReady] = useState(false);\n  const dispatch = useDispatch();\n  const orderDetails = useSelector(state => state.orderDetails);\n  const {\n    order,\n    loading,\n    error\n  } = orderDetails;\n  const orderPay = useSelector(state => state.orderPay);\n  const {\n    loading: loadingPay,\n    success: successPay\n  } = orderPay;\n  const orderDeliver = useSelector(state => state.orderDeliver);\n  const {\n    loading: loadingDeliver,\n    success: successDeliver\n  } = orderDeliver;\n\n  if (!loading) {\n    //합산\n    order.itemsPrice = order.orderItems.reduce((acc, item) => acc + item.price * item.qty, 0);\n  }\n\n  useEffect(() => {\n    const addPayPalScript = async () => {\n      const {\n        data: clientId\n      } = await axios.get('/api/config/paypal');\n      const script = document.createElement('script');\n      script.type = 'text/javascript';\n      script.src = `https://www.paypal.com/sdk/js?client-id=${clientId}`;\n      script.async = true;\n\n      script.onload = () => {\n        setSdkReady(true);\n      };\n\n      document.body.appendChild(script);\n    };\n\n    if (!order || successPay || successDeliver) {\n      dispatch({\n        type: ORDER_PAY_RESET\n      });\n      dispatch({\n        type: ORDER_DELIVER_RESET\n      });\n      dispatch(getOrderDetails(orderId));\n    } else if (!order.isPaid) {\n      if (!window.paypal) {\n        addPayPalScript();\n      } else {\n        setSdkReady(true);\n      }\n    }\n  }, [dispatch, orderId, order, successPay]);\n\n  const successPaymentHandler = paymentResult => {\n    console.log(paymentResult);\n    dispatch(payOrder(orderId, paymentResult));\n  };\n\n  const deliverHandler = () => {\n    dispatch(deliverOrder(order));\n  };\n\n  return loading ? /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 22\n  }, this) : error ? /*#__PURE__*/_jsxDEV(Message, {\n    variant: \"danger\",\n    children: error\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 5\n  }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: [\"\\uC8FC\\uBB38\\uBC88\\uD638 \", order._id]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      children: [/*#__PURE__*/_jsxDEV(Col, {\n        md: 8,\n        children: /*#__PURE__*/_jsxDEV(ListGroup, {\n          variant: \"flush\",\n          children: [/*#__PURE__*/_jsxDEV(ListGroup.Item, {\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"\\uBC30\\uC1A1\\uC9C0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 87,\n              columnNumber: 28\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\uC774\\uB984 : \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 89,\n                columnNumber: 28\n              }, this), \" \", order.user.name]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 88,\n              columnNumber: 28\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\uC774\\uBA54\\uC77C : \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 92,\n                columnNumber: 28\n              }, this), \" \", /*#__PURE__*/_jsxDEV(\"a\", {\n                href: `mailto:${order.user.email}`,\n                children: order.user.email\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 92,\n                columnNumber: 52\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 91,\n              columnNumber: 28\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\uC8FC\\uC18C : \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 95,\n                columnNumber: 32\n              }, this), order.shippingAddress.address, \",\", order.shippingAddress.city, \",\", order.shippingAddress.postalCode, \",\", ' ', order.shippingAddress.country]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 94,\n              columnNumber: 28\n            }, this), order.isDelived ? /*#__PURE__*/_jsxDEV(Message, {\n              variant: \"success\",\n              children: [\"\\uBC30\\uB2EC\\uC644\\uB8CC \", order.DelivedAt]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 102,\n              columnNumber: 33\n            }, this) : /*#__PURE__*/_jsxDEV(Message, {\n              variant: \"danger\",\n              children: \"\\uBC30\\uB2EC\\uC900\\uBE44\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 104,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 24\n          }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"\\uACB0\\uC81C \\uBC29\\uBC95\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 109,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\uC9C0\\uBD88 \\uC120\\uD0DD :\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 111,\n                columnNumber: 29\n              }, this), order.paymentMethod]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 110,\n              columnNumber: 29\n            }, this), order.isPaid ? /*#__PURE__*/_jsxDEV(Message, {\n              variant: \"success\",\n              children: [\"\\uACB0\\uC81C\\uC644\\uB8CC \", order.paidAt]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 33\n            }, this) : /*#__PURE__*/_jsxDEV(Message, {\n              variant: \"danger\",\n              children: \"\\uBBF8\\uACB0\\uC81C\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 117,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 24\n          }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"\\uC8FC\\uBB38 \\uC0C1\\uD488\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 122,\n              columnNumber: 29\n            }, this), order.orderItems.length === 0 ? /*#__PURE__*/_jsxDEV(Message, {\n              children: \"\\uC8FC\\uBB38\\uC774 \\uC5C6\\uC2B5\\uB2C8\\uB2E4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 124,\n              columnNumber: 33\n            }, this) : /*#__PURE__*/_jsxDEV(ListGroup, {\n              varaiant: \"flush\",\n              children: order.orderItems.map((item, index) => /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    md: 1,\n                    children: /*#__PURE__*/_jsxDEV(Image, {\n                      src: item.image,\n                      alt: item.name,\n                      fluid: true,\n                      rounded: true\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 130,\n                      columnNumber: 57\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 129,\n                    columnNumber: 53\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: /*#__PURE__*/_jsxDEV(Link, {\n                      to: `/product/${item.product}`,\n                      children: item.name\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 139,\n                      columnNumber: 57\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 138,\n                    columnNumber: 53\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    md: 4,\n                    children: [item.price, \"\\uC6D0 X \", item.qty, \"\\uAC1C = \", item.qty * item.price, \"\\uC6D0\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 143,\n                    columnNumber: 53\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 128,\n                  columnNumber: 49\n                }, this)\n              }, index, false, {\n                fileName: _jsxFileName,\n                lineNumber: 127,\n                columnNumber: 45\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 125,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 24\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 20\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 16\n      }, this), /*#__PURE__*/_jsxDEV(Col, {\n        md: 4,\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          children: /*#__PURE__*/_jsxDEV(ListGroup, {\n            variant: \"flush\",\n            children: [/*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: /*#__PURE__*/_jsxDEV(\"h2\", {\n                children: \"\\uC8FC\\uBB38 \\uC694\\uC57D\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 159,\n                columnNumber: 32\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 158,\n              columnNumber: 28\n            }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: /*#__PURE__*/_jsxDEV(Row, {\n                children: [/*#__PURE__*/_jsxDEV(Col, {\n                  children: \"\\uC8FC\\uBB38 \\uC0C1\\uD488\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 164,\n                  columnNumber: 36\n                }, this), /*#__PURE__*/_jsxDEV(Col, {\n                  children: [order.itemsPrice, \" \\uC6D0\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 165,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 163,\n                columnNumber: 32\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 162,\n              columnNumber: 28\n            }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: /*#__PURE__*/_jsxDEV(Row, {\n                children: [/*#__PURE__*/_jsxDEV(Col, {\n                  children: \"\\uBC30\\uC1A1\\uBE44\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 171,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(Col, {\n                  children: [order.shippingPrice, \"\\uC6D0\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 172,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 170,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 169,\n              columnNumber: 28\n            }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: /*#__PURE__*/_jsxDEV(Row, {\n                children: [/*#__PURE__*/_jsxDEV(Col, {\n                  children: \"\\uAD00\\uC138 \\uBC0F \\uBD80\\uACFC\\uC138 \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 178,\n                  columnNumber: 36\n                }, this), /*#__PURE__*/_jsxDEV(Col, {\n                  children: [order.taxPrice, \"\\uC6D0\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 179,\n                  columnNumber: 36\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 177,\n                columnNumber: 32\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 176,\n              columnNumber: 28\n            }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: /*#__PURE__*/_jsxDEV(Row, {\n                children: [/*#__PURE__*/_jsxDEV(Col, {\n                  children: \"\\uC8FC\\uBB38 \\uCD1D\\uC561\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 185,\n                  columnNumber: 36\n                }, this), /*#__PURE__*/_jsxDEV(Col, {\n                  children: [order.totalPrice, \"\\uC6D0\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 186,\n                  columnNumber: 36\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 184,\n                columnNumber: 32\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 183,\n              columnNumber: 28\n            }, this), !order.isPaid && /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: [loadingPay && /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 192,\n                columnNumber: 52\n              }, this), !sdkReady ? /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 194,\n                columnNumber: 41\n              }, this) : /*#__PURE__*/_jsxDEV(PayPalButton, {\n                amount: order.totalPrice,\n                onSuccess: successPaymentHandler\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 196,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 35\n            }, this), userInfo.isAdmin && order.isPaid && !order.isDelived && /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                type: \"button\",\n                clasName: \"btn btn-block\",\n                onClick: deliverHandler,\n                children: \"Mark As Delivered\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 206,\n                columnNumber: 39\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 35\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 157,\n            columnNumber: 24\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 20\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 16\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n};\n\n_s(OrderScreen, \"uP4H4ybuNQIHF1ZVRPKJhjtHEbk=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useSelector];\n});\n\n_c = OrderScreen;\nexport default OrderScreen;\n\nvar _c;\n\n$RefreshReg$(_c, \"OrderScreen\");","map":{"version":3,"sources":["D:/ByungSoo/DEV/potfolio/ecommerce_react/frontend/src/screens/OrderScreen.js"],"names":["React","useState","useEffect","axios","PayPalButton","Link","Row","Col","ListGroup","Image","Card","Button","useDispatch","useSelector","Message","Loader","deliverOrder","getOrderDetails","payOrder","ORDER_DELIVER_RESET","ORDER_PAY_RESET","OrderScreen","match","orderId","params","id","sdkReady","setSdkReady","dispatch","orderDetails","state","order","loading","error","orderPay","loadingPay","success","successPay","orderDeliver","loadingDeliver","successDeliver","itemsPrice","orderItems","reduce","acc","item","price","qty","addPayPalScript","data","clientId","get","script","document","createElement","type","src","async","onload","body","appendChild","isPaid","window","paypal","successPaymentHandler","paymentResult","console","log","deliverHandler","_id","user","name","email","shippingAddress","address","city","postalCode","country","isDelived","DelivedAt","paymentMethod","paidAt","length","map","index","image","product","shippingPrice","taxPrice","totalPrice","userInfo","isAdmin"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport axios from 'axios'\r\nimport { PayPalButton } from 'react-paypal-button-v2'\r\nimport { Link } from 'react-router-dom'\r\nimport {Row, Col, ListGroup, Image, Card, Button } from 'react-bootstrap'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport Message from '../components/Message'\r\nimport Loader from '../components/Loader'\r\nimport { deliverOrder, getOrderDetails, payOrder } from '../actions/orderActions'\r\nimport { ORDER_DELIVER_RESET, ORDER_PAY_RESET } from '../constants/orderConstants'\r\n\r\nconst OrderScreen = ({match}) => {\r\n    const orderId = match.params.id\r\n\r\n    const [sdkReady, setSdkReady] = useState(false)\r\n    \r\n    const dispatch = useDispatch()\r\n\r\n  \r\n    const orderDetails = useSelector(state => state.orderDetails)\r\n    const { order, loading, error } = orderDetails \r\n\r\n    const orderPay = useSelector(state => state.orderPay )\r\n    const { loading: loadingPay , success: successPay } = orderPay  \r\n\r\n    const orderDeliver = useSelector(state => state.orderDeliver)\r\n    const { loading : loadingDeliver, success : successDeliver } = orderDeliver\r\n\r\n\r\n   \r\n     if(!loading){\r\n    \r\n        //합산\r\n        order.itemsPrice = order.orderItems.reduce((acc, item) => acc + item.price * item.qty, 0)\r\n        \r\n     }\r\n\r\n\r\n    useEffect(() => {\r\n        const addPayPalScript = async () => {\r\n            const { data: clientId } = await axios.get('/api/config/paypal')\r\n            const script = document.createElement('script')\r\n            script.type = 'text/javascript'\r\n            script.src = `https://www.paypal.com/sdk/js?client-id=${clientId}`\r\n            script.async = true\r\n            script.onload = () => {\r\n                setSdkReady(true)\r\n            }\r\n            document.body.appendChild(script)\r\n         }\r\n\r\n    \r\n        if(!order || successPay || successDeliver){\r\n            dispatch( { type : ORDER_PAY_RESET })\r\n            dispatch( { type : ORDER_DELIVER_RESET })\r\n            dispatch(getOrderDetails(orderId))\r\n        }else if(!order.isPaid){\r\n            if(!window.paypal){\r\n                addPayPalScript()\r\n            }else {\r\n                setSdkReady(true)\r\n            }\r\n        }\r\n\r\n    }, [ dispatch ,orderId, order, successPay])\r\n\r\n    const successPaymentHandler = (paymentResult) => {\r\n        console.log(paymentResult)\r\n        dispatch(payOrder(orderId, paymentResult))\r\n    }\r\n\r\n    const deliverHandler = () => {\r\n        dispatch(deliverOrder(order))\r\n    }\r\n\r\n\r\n\r\n    return loading ? <Loader /> : error ? \r\n    <Message variant='danger'>{error}</Message> : \r\n    <> \r\n        <h1>주문번호 {order._id}</h1>\r\n        <Row>\r\n               <Col md={8}>\r\n                   <ListGroup variant='flush'>\r\n\r\n                       <ListGroup.Item>\r\n                           <h2>배송지</h2>\r\n                           <p>\r\n                           <strong>이름 : </strong> {order.user.name}\r\n                           </p>\r\n                           <p>\r\n                           <strong>이메일 : </strong> <a href={`mailto:${order.user.email}`}>{order.user.email}</a>\r\n                           </p>\r\n                           <p>\r\n                               <strong>주소 : </strong>\r\n                               {order.shippingAddress.address},\r\n                               {order.shippingAddress.city},\r\n                               {order.shippingAddress.postalCode},{' '}\r\n                               {order.shippingAddress.country}\r\n                           </p>\r\n                           {order.isDelived ? (\r\n                                <Message variant='success'>배달완료 {order.DelivedAt}</Message>\r\n                            ) : (\r\n                                <Message variant='danger'>배달준비</Message>\r\n                            )}\r\n                       </ListGroup.Item>\r\n\r\n                       <ListGroup.Item>\r\n                            <h2>결제 방법</h2>\r\n                            <p>\r\n                            <strong>지불 선택 :</strong>\r\n                            {order.paymentMethod}\r\n                            </p>\r\n                            {order.isPaid ? (\r\n                                <Message variant='success'>결제완료 {order.paidAt}</Message>\r\n                            ) : (\r\n                                <Message variant='danger'>미결제</Message>\r\n                            )}\r\n                       </ListGroup.Item>\r\n\r\n                       <ListGroup.Item>\r\n                            <h2>주문 상품</h2>\r\n                            {order.orderItems.length === 0 ? \r\n                                <Message>주문이 없습니다</Message> : (\r\n                                    <ListGroup varaiant='flush'>\r\n                                        {order.orderItems.map((item, index) => (\r\n                                            <ListGroup.Item key={index}>\r\n                                                <Row>\r\n                                                    <Col md={1}>\r\n                                                        <Image \r\n                                                        src={item.image} \r\n                                                        alt={item.name}\r\n                                                        fluid \r\n                                                        rounded\r\n                                                        />\r\n                                                    </Col>\r\n\r\n                                                    <Col>\r\n                                                        <Link to={`/product/${item.product}`}>\r\n                                                            {item.name}\r\n                                                        </Link>\r\n                                                    </Col>\r\n                                                    <Col md={4}>\r\n                                                          {item.price}원 X {item.qty}개 = {item.qty * item.price}원\r\n                                                    </Col>\r\n                                                </Row>\r\n                                            </ListGroup.Item>\r\n                                        ))}\r\n                                    </ListGroup>\r\n                                )}\r\n                       </ListGroup.Item>\r\n                   </ListGroup>\r\n               </Col>\r\n\r\n               <Col md={4}>\r\n                   <Card>\r\n                       <ListGroup variant='flush'>\r\n                           <ListGroup.Item>\r\n                               <h2>주문 요약</h2>                     \r\n                           </ListGroup.Item>\r\n\r\n                           <ListGroup.Item>\r\n                               <Row>\r\n                                   <Col>주문 상품</Col>   \r\n                                        <Col>{order.itemsPrice} 원</Col>                                                              \r\n                               </Row>\r\n                           </ListGroup.Item>\r\n                            \r\n                           <ListGroup.Item>\r\n                                <Row>\r\n                                    <Col>배송비</Col>\r\n                                    <Col>{order.shippingPrice}원</Col>\r\n                                </Row>                  \r\n                           </ListGroup.Item>\r\n\r\n                           <ListGroup.Item>\r\n                               <Row>\r\n                                   <Col>관세 및 부과세 </Col>\r\n                                   <Col>{order.taxPrice}원</Col>\r\n                               </Row>\r\n                           </ListGroup.Item>\r\n\r\n                           <ListGroup.Item>\r\n                               <Row>\r\n                                   <Col>주문 총액</Col>\r\n                                   <Col>{order.totalPrice}원</Col>\r\n                               </Row>\r\n                           </ListGroup.Item>\r\n\r\n                              {!order.isPaid && (\r\n                                  <ListGroup.Item>\r\n                                    {loadingPay && <Loader />}\r\n                                    {!sdkReady ? (\r\n                                        <Loader />\r\n                                    ) : (\r\n                                        <PayPalButton\r\n                                            amount = {order.totalPrice}\r\n                                            onSuccess = {successPaymentHandler}\r\n                                        />\r\n                                    )}\r\n                                 </ListGroup.Item>   \r\n                              )}   \r\n\r\n                              {userInfo.isAdmin && order.isPaid && !order.isDelived && (\r\n                                  <ListGroup.Item>\r\n                                      <Button \r\n                                        type='button' \r\n                                        clasName='btn btn-block'\r\n                                        onClick = {deliverHandler}>\r\n                                            Mark As Delivered\r\n                                        </Button>\r\n                                  </ListGroup.Item>\r\n                              )}               \r\n                       </ListGroup>\r\n                   </Card>\r\n               </Col>\r\n           </Row>\r\n    </>\r\n}\r\n\r\nexport default OrderScreen\r\n"]},"metadata":{},"sourceType":"module"}